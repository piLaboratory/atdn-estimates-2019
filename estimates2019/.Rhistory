mean(log(reg.ls.rad))
mean(log(ls.rnd[ls.rnd>0]))
mean(log(Dec2018$population))
sd(log(Dec2018$population))
nrow(Dec2018)
system.time(teste <- sim.abc(S = S.reg1, N = Tot.t, tot.area= Tot.A, lmk = lm.k, nrep = 2))
S.reg1-S.reg2
2500*3.95
2500*3.95/60^2
2.7/4
system.time(teste <- sim.abc(S = S.reg1, N = Tot.t, tot.area= Tot.A, lmk = lm.k, nrep = 20))
system.time(teste <- sim.abc(S = S.reg1, N = Tot.t, tot.area= Tot.A, lmk = lm.k, nrep = 10))
summary(y.nb2)
y.nb2
str(y.nb2)
class(nb.y2)
class(y.nb2)
class(y.nb2)=="fitsad"
system.time(teste2 <- sim.abc(S = S.reg1, N = Tot.t, tot.area= Tot.A, nb.fit=nb.y2, lmk = lm.k, nrep = 10, LS=FALSE))
system.time(teste2 <- sim.abc(S = S.reg1, N = Tot.t, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
debug(sim.abc)
system.time(teste2 <- sim.abc(S = S.reg1, N = Tot.t, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
k
csi.p
csi
log(csi)
log(csi)
Q
log(csi)
system.time(teste2 <- sim.abc(S = S.nb, N = Tot.t, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
system.time(teste2 <- sim.abc(S = S.nb, N = Tot.t, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
teste2
system.time(teste2 <- sim.abc(S = S.nb, N = Tot.t, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
teste2
log(mean(nb.rnd[nb.rnd>0]))
system.time(teste2 <- sim.abc(S = S.nb, N = Tot.t, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
system.time(teste2 <- sim.abc(S = S.nb, N = Tot.t, n.plots = N.plots, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
teste2
length(nb.clump)
sum(nb.clump>0)
mean(log(nb.clump[nb.clump>0]))
sd(log(nb.clump[nb.clump>0]))
sum(nb.rnd>0)
mean(log(nb.clump[nb.rnd>0]))
mean(log(nb.rnd[nb.rnd>0]))
sd(log(nb.rnd[nb.rnd>0]))
S.reg1
f1(S.reg1)
f1
f1(S.reg1)
S.reg1
system.time(teste2 <- sim.abc(S = S.reg1, N = Tot.t, n.plots = N.plots, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
debug(sim.abc)
system.time(teste2 <- sim.abc(S = S.reg1, N = Tot.t, n.plots = N.plots, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
system.time(teste2 <- sim.abc(S = S.reg1, N = Tot.t, n.plots = N.plots, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
csi
1-csi
rad <- rad.posnegbin(S, k, 1 - csi, lower=1e-12, upper=1e12)
rad <- rad.posnegbin(S, k, 1 - csi, lower=1e-12, upper=1e12)
csi
1-csi
max(ppoints(S))
qposnegbin2(max(ppoints(S)), size=k, prob=1-csi)
qposnegbin2(min(ppoints(S)), size=k, prob=1-csi)
qposnegbin2(min(ppoints(S)), size=k, prob=1-csi, upper=1e20)
qposnegbin2(max(ppoints(S)), size=k, prob=1-csi, upper=1e20)
Q
system.time(teste2 <- sim.abc(S = S.reg1, N = Tot.t, n.plots = N.plots, tot.area= Tot.A, nb.fit=y.nb2, lmk = lm.k, nrep = 10, LS=FALSE))
head(teste)
unlist(teste)
lenght(teste)
length(teste)
teste[[1]]
teste[[10]]
stat.voight
dim(models)
length(models)
dim(stat.3pops.sim)
head(teste2)
summary(teste3)
summary(teste3)
)
summary(teste3)
4230/3600
4230/60
423/60
head(unlist(LS.sims))
head(unlist(LS.sims), 12)
dim(LS.sims)
head(matrix(unlist(LS.sims), ncol=4, nrow=100, by.row=TRUE))
head(matrix(unlist(LS.sims), ncol=4, nrow=100, byrow=TRUE))
head(matrix(unlist(LS.sims), ncol=4, nrow=100))
head(all.sims)
teste3
summary(teste3)
S.post
summary(S.post)
S.reg1
head(stat.italy.sim)
summary(S.post)
hist(S.post)
S.nb
S.orc$S.est
head(simulated.vals)
head(simulated.vals)
tail(simulated.vals)
summary(model.sel)
S.post
summary(S.post)
hist(S.post)
hist(post)
hist(S.post)
hist(S.post)
hist(S.post)
summary(S.post)
summary(S.post)
hist(S.post)
hist(S.post)
LC.sims[[1]]
LS.sims[[1]]
save.image()
summary(model.sel)
hist(S.post)
par(mfrow=c(2,2))
plot(S.post)
plot(S.post, param="P1")
S.reg1
summary(S.post)
par(mfrow=c(1,1))
mean((log(Dec2018$population) - log(ls.clump[1:nrow(Dec2018)]))^2)
mean((log(Dec2018$population) - log(ls.abc.clump[1:nrow(Dec2018)]))^2)
summary(S.post)
Summary(S.post)
summary(S.post)
S.reg1
summary(S.post)
NB.sims
NB.sims
MS(ls.rnd, Dec2018$population)
simulated.vals
49*3/60
49*30/60
NB.sims
system.time(NB.sims <- mclapply(simulated.vals, f1, lower=1, upper=1e20, LS = FALSE, mc.cores=3))
NB.sims
S.reg1
S.reg2
NB.sims
simulated.vals[8]
S.reg1
simulated.vals[7]
save.image()
length(NB.sims)
NB.sims[[300]]
NB.sims[[1]]
any(is.na(NB.sims[[300]]))
any(is.na(NB.sims[[1]]))
sum(oksim)
(1:length(NB.sims))[oksim]
(1:length(NB.sims))[oksim]
any(is.na(NB.sims[[200]]))
NB.sims[[200]]
NB.sims[[201]]
summary(S.post)
summary(S.post)
summary(S.post)
summary(S.post)
hist(S.post)
summary(S.post)
summary(S.post)
hist(S.post)
hist(S.post)
hist(S.post)
summary(S.post)
S.reg1
dim(tmp)
head(tmp2)
head(tmp2)
)
summary(S.post)
hist(S.pos)
hist(S.post)
head(all.sims)
)
length(oksim)
length(simulated.vals)
unique(sim.ids)
)
names(all.sims)
)
names(al..sim)
names(all.sims)
summary(log(Dec2018$population))
boxplot(log(Dec2018$population))
1/(sum((Dec2018$population/sum(Dec2018$population))^2))
1/(sum((ls.clump/sum(ls.clump))^2))
1/(sum((ls.rnd/sum(ls.rnd))^2))
1/(sum((nb.rnd/sum(nb.rnd))^2))
40*10/60
save.image()
names(Dec2018)
round(Sobs/(1-pln.d0))
S.obs
cf.st2
cf.st1
source("functions.R")
S.orc$S.est
nb.S
S.nb
save.image()
q()
y
save.image()
tmp <- Pois.samp(reg.ls.rad, Tot.A, N.plots, nrep=1)
tmp
class(tmp)
tmp <- NB.samp(reg.ls.rad, Tot.A, N.plots, reg.nb.rad.lk, lm.k.sigma, nrep=1)
class(tmp)
system.time(tmp1 <- mclapply(simulated.vals, f1, mc.cores=4))
24800/3600
stopCluster(cl1)
stopCluster(cl1)
q()
y
lenght(teste)
length(teste)
f1
stopCluster(cl1)
head(teste)
save.image()
system.time(tmp1 <- mclapply(simulated.vals, f1, mc.cores=4))
26600/3600 +8500/3600
266/60
system.time(tmp1 <- mclapply(simulated.vals, f1, mc.cores=4))
(266+89)*60
(266+89)/60
(266+89)*100/3600
(266+89)*80/3600
save.image()
save.image()
sum(oksim)
oksim <- sapply(Ls.sims, function(x) !any(is.na(x)))
oksim <- sapply(LS.sims, function(x) !any(is.na(x)))
sum(oksim)
Sobs
S.reg1
S.reg
hist(S.post)
hist(S.post)
hist(S.post)
S.r.ls
S.r.ln
length(j1)
dim(all.sims[sim.ids=="LSclump",])
S.ls
hist(S.post)
hist(S.post)
S.reg.ln
S.r.ln
hist(S.post)
hist(S.post)
hist(S.post)
summary(S.post)
S.r.ls
hist(S.post)
hist(S.post)
S.ls
S.r.ln
S.nb
summary(cv.nn)
summary(cv.rej)
target
target
head(all.sims)
postpr
head(sim.ids)
D(Dec2018$population[-1:3])
D(Dec2018$population[-1:3])
D(Dec2018$population[-c(1:3)])
D(Dec2018$population)
S.ls.reg
S.r.ls
S.r.ln
str(S.post1)
par(mfrow=c(1,1))
head(all.sims)
S.nb
csi.p
head(rad.abc)
tail(rad.abc)
quantile(Dec2018$population)
quantile(log(Dec2018$population))
abline(h=quantile(log(Dec2018$population)))
abline(h=1.698567e+06)
abline(h=8.906955e+06)
abline(h=4.295380e+07)
locator(5)
c(120, 1070, 3780, 4680, 5000)/S.obs
c(120, 1070, 3780, 4680, 5000)/Sobs
abline(h=quantile(Dec2018$population),0.025)
abline(h=quantile(Dec2018$population,0.025))
abline(h=quantile(Dec2018$population,0.02))
1-c(120, 1070, 3780, 4680, 5000)/Sobs
abline(h=quantile(Dec2018$population,0.006))
abline(h=quantile(Dec2018$population,0.007), col="blue")
abline(h=quantile(Dec2018$population,0.07), col="blue")
abline(h=quantile(Dec2018$population,0.05), col="blue")
abline(h=quantile(Dec2018$population,0.75), col="blue")
abline(h=quantile(Dec2018$population,0.8), col="blue")
abline(h=quantile(Dec2018$population,0.25), col="blue")
y <- locator(5)
locator(2)
1-c(1248,3563)/Nobs
1-c(1248,3563)/Sobs
abline(h=quantile(Dec2018$population,0.25), col="blue")
abline(h=quantile(Dec2018$population,0.75), col="blue")
y <- locator(6)
y
1-y$x/Sobs
save(NB.sims,simulated.vals, all.sims, sim.ids, NB.index, LS.index, sim.y, j1, j2, file="abc_S_D_lmean_lsd.RDATA")
nobs*0.0075
Sobs*0.0075
Sobs*0.0079
debug(sim.abc)
sim.abc(S = 12000, N = Tot.t, n.plots = N.plots, tot.area= Tot.A,
                     nb.fit=y.nb2, lmk = lm.k, obs.values=Dec2018$population,
                     nrep = 1)
sim.abc(S = 12000, N = Tot.t, n.plots = N.plots, tot.area= Tot.A,
                     nb.fit=y.nb2, lmk = lm.k, obs.values=Dec2018$population,
                     nrep = 1)
cbind(results,quantis)
cbind(results,quantis)
cbind(results,quantis)
cbind(results,quantis)
names(quantis)
class(quantis)
cbind(results,quantis)
class(cbind(results,quantis))
Q
. + 
LS.sims
all.sims
save.image()
dim(tmp1)
dim(tmp1)
q()
y
dim(all.sims)
length(NB.sims2)
length(NB.sims)
9*60/4000
4000/9*60
4000/(9*60)
4000/9
range(sim.y)
range(simulated.vals2)
range(simulated.vals)
dim(LS.sims2)
lengt(LS.sims2)
length(LS.sims2)
length(LS.sims)
load("abc_4000_mais_1000_S_D_lmean_lsd.RData")
dim(all.sims2)
dim(all.sims)
length(sim.y)
length(sim.y)/4
range(sim.y)
range(simulated.vals2)
range(simulated.vals)
save("2018_12_20.RData")
save.image(file="2018_12_20.RData")
dim(LS.sims)
length(LS.sims)
length(NB.sims)
length(sim.vals)
length(sims.val)
length(simulated.vals)
LS.sims2 <- LS.sims
NB.sims2 <- NB.sims
simulated.vals2 <- simulated.vals
dim(all.sims)
dim(all.sims2)
length(sim.y)
length(sim.y)/4
all.sims <- rbind(all.sims, all.sims2)
sim.y <- rbind(sim.y, sim.y2)
load("abc_4000_mais_1000_S_D_lmean_lsd.RData")
all.sims <- rbind(all.sims, all.sims2)
sim.y <- c(sim.y, sim.y2)
length(sim.ids)
length(sim.ids2)
sim.ids <- c(sim.ids,sim.ids2)
dim(all.sims)
length(sim.ids)
length(simulated.vals)
dim(all.sims)
dim(all.sims2)
q()
n
length(simulated.vals)
dim(all.sims)
dim(LS.sims)
length(LS.sims)
length(NB.sims)
dim(all.sims2)
length(sim.ids2)
length(sim.y2)
dim(all.sims)
length(sim.ids)
length(sim.y)
dim(sims.2)
dim(all.sims2)
dim(all.sims2)/2
save(all.sims, sim.ids, sim.y, file="abc_1000_to_2000_S.RData")
str(summary(model.sel))
str(S.post1.s)
S.post1.s["Mean"]
S.post1.s["Mean:"]
S.post1.s["Mean:",]
round(S.post1.s[2,])
round(S.post1.s[6,])
S.ulrich
S.ulrich$S
S.ls
S.post1.s[2,]
S.post1.s[3,]
S.post1.s[4,]
S.post1.s
par(mfrow=c(1,1))
S.post1.s
S.orc
S.sh
S.orc
tovo.S
round(summary(model.sel)$Prob[["LSclump"]],2)
summary(model.sel)$Prob[["LSclump"]]
round(S.sh)
S.sh
S.sh
Y
S.sh
S.sh
S.sh
S.sh
)
S.sh
round(summary(model.sel)$Prob[["LSclump"]],3)
round(summary(model.sel)$Prob[["LSclump"]],4)
round(summary(model.sel)$Prob[["LSclump"]],5)
round(msel.s$Prob[["LSclump"]],3)
round(msel.s$Prob[["LSclump"]],4)
round(msel.s$Prob[["LSclump"]],4)
str(msel.s)
msel.s$Prob
msel.s$Prob[1]
msel.s$Prob[1,]
msel.s$Prob[1:2]
msel.s$Prob[1:2][1]
msel.s
msel.s$Prob
msel.s$Prob[2]
unanme(msel.s$Prob[1])
unnanme(msel.s$Prob[1])
unname(msel.s$Prob[1])
1-msel.s$Prob[1]
1-(1-msel.s$Prob[1])
print(msel.s$Prob[["LSclump"]],digits=4)
citation("abc")
q()
y
save.image()
save.image()
getwd()
source("functions.R")
source("../functions.R")
ls()
rm(list=ls())
ls()
source("../functions.R")
q()
n
y.nb2
coef(y.nb2)
coef(y.nb2)
library(sads)
coef(y.nb2)
getwd()
q()
y
ls()
rm(list=ls())
)
length(LSclump.pc)
str(LSclump.pc)
names(tmp1)
names(abc2019$sims)
q()
y
q()
n
